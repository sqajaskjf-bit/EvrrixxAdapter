<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Evrrixx — profile</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>
  <!-- ВЕРХ: устройство + просмотры -->
  <div class="top-right">
    <div id="device-toggle" class="device-toggle">
      <button id="btn-pc" class="device-btn" title="PC view"><i class="fa-solid fa-desktop"></i></button>
      <button id="btn-phone" class="device-btn" title="Mobile view"><i class="fa-solid fa-mobile-screen-button"></i></button>
    </div>
    <div id="view-count" class="view-count">👁️ <span id="views">0</span> views</div>
  </div>

  <!-- Оверлей -->
  <div id="overlay" class="overlay">
    <div id="overlayBtn" class="overlay-cta">Click to continue</div>
  </div>

  <!-- Карточка -->
  <main class="card">
    <aside class="left">
      <div class="avatar-wrap">
        <img class="avatar" src="https://avatars.mds.yandex.net/i?id=37e394a9871b342e37f3dca00c22c825e9bf71b8-5886795-images-thumbs&n=13" alt="avatar">
      </div>
      <div class="profile-meta">
        <div class="nick">Evrrixx</div>
        <div class="meta">
          <a href="https://www.google.com/maps/place/Lviv" target="_blank" class="location">
            <i class="fa-solid fa-location-dot"></i> Lviv
          </a>
        </div>
        <div class="osu-stats">
          🌍 World #1.1kk | 🇺🇦 Country #22k
        </div>
      </div>
      <div class="neon-buttons">
        <a class="btn" href="https://discord.com/users/1379041675070148670"><i class="fa-brands fa-discord"></i></a>
        <a class="btn" href="https://t.me/Evrrixx"><i class="fa-brands fa-telegram"></i></a>
        <a class="btn" href="https://www.tiktok.com/@svalipchik"><i class="fa-brands fa-tiktok"></i></a>
        <a class="btn" href="https://osu.ppy.sh/users/38462434"><i class="fa-solid fa-circle"></i></a>
      </div>
    </aside>

    <!-- ПРАВО -->
    <section class="right">
      <div class="top-row">
        <div class="nick-large">Evrrixx</div>
        <div class="views-inline">👁️ <span id="views-inline">0</span></div>
      </div>
      <p class="bio"><strong>OSU player</strong></p>

      <!-- ПЛЕЕР -->
      <div class="player">
        <img class="track-cover" src="https://images.genius.com/58bde3f707f18fb105b26ee786f24bad.1000x1000x1.png" alt="track cover">
        <div class="player-body">
          <div class="track-title">baby cute — универ</div>
          <div class="progress-wrap"><div id="progressBar" class="progress-bar"></div></div>
          <div class="player-controls">
            <button id="playBtn" class="control"><i class="fa-solid fa-play"></i></button>
            <span class="time"><span id="currentTime">0:00</span> / <span id="totalTime">0:00</span></span>
            <input id="volume" class="volume-slider" type="range" min="0" max="1" step="0.01" value="0.8">
          </div>
        </div>
      </div>
    </section>
  </main>

  <audio id="audio" preload="metadata">
    <source src="https://sefon.pro/api/mp3_download/direct/1362072/3vUCAL9SUTYUJlpqN96WmNiAVCIkVxwbfrpr1nc34l9vjo7WZbWMezr6WL9BMVq0tHqmbpdsiBmSi1pqocPzFN58ejf8EBJJwkPbEh3iQhHt9sLRFfef4pIcMNiie8U2AI0x7_Ei0ub0xroANdPEMrWr0xjdHUfGSpnN8EoQ/" type="audio/mpeg">
  </audio>

  <script>
    const overlay = document.getElementById('overlay');
    const audio = document.getElementById('audio');
    const playBtn = document.getElementById('playBtn');
    const progressBar = document.getElementById('progressBar');
    const currentTimeEl = document.getElementById('currentTime');
    const totalTimeEl = document.getElementById('totalTime');
    const volumeSlider = document.getElementById('volume');
    const viewCountEl = document.getElementById('views');
    const viewCountInline = document.getElementById('views-inline');

    function fmtTime(t) {
      if (!isFinite(t)) return "0:00";
      const m = Math.floor(t / 60);
      const s = Math.floor(t % 60).toString().padStart(2, "0");
      return `${m}:${s}`;
    }

    // Запуск после клика
    overlay.addEventListener('click', async () => {
      overlay.classList.add('hidden');
      try {
        await audio.play();
        playBtn.innerHTML = '<i class="fa-solid fa-pause"></i>';
      } catch (err) {
        console.log('Audio blocked', err);
      }
    });

    // Play / Pause
    playBtn.addEventListener('click', () => {
      if (audio.paused) {
        audio.play();
        playBtn.innerHTML = '<i class="fa-solid fa-pause"></i>';
      } else {
        audio.pause();
        playBtn.innerHTML = '<i class="fa-solid fa-play"></i>';
      }
    });

    // Обновление времени
    audio.addEventListener('loadedmetadata', () => {
      totalTimeEl.textContent = fmtTime(audio.duration);
    });
    audio.addEventListener('timeupdate', () => {
      currentTimeEl.textContent = fmtTime(audio.currentTime);
      progressBar.style.width = (audio.currentTime / audio.duration) * 100 + "%";
    });

    // Громкость
    volumeSlider.addEventListener('input', e => audio.volume = e.target.value);

    // Реальный счётчик просмотров
    fetch('https://api.countapi.xyz/hit/evrrixx-bio/views')
      .then(res => res.json())
      .then(data => {
        const v = data.value;
        viewCountEl.textContent = v.toLocaleString();
        viewCountInline.textContent = v.toLocaleString();
      });

    // Автопауза при уходе
    document.addEventListener("visibilitychange", () => {
      if (document.hidden) audio.pause();
    });
  </script>
</body>
</html>
